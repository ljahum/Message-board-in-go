# A extend of ctf-wiki

> çŸ¥è¯†ç‚¹å¤ªå¤šäº†å›å¿†ä¸è¿‡æ¥äº†ğŸ˜«ğŸ˜«ğŸ˜«,å„ä½å¤šå¤šæ¥æ·»ç –åŠ ç“¦ORZ
>
> æŒ‰ç…§wikiçš„è·¯çº¿åšä¸€äº›æ‰©å±•,æ”¾ä¸€äº›å¥½çš„å­¦ä¹ èµ„æ–™å’Œè¿æ¥ä¸Šå»
>
> è„šæœ¬(ä¸€æŠŠæ¢­å“ˆçš„è½®å­)åœ¨ç½‘ä¸Šåº”è¯¥éƒ½èƒ½æ‰¾åˆ°

# In the frist:Using sagemath in a grace way

- æä¸€ä¸ªWindows termialï¼ˆå¾ˆDuangå¾ˆæ¼‚äº®ï¼‰

- æä¸€ä¸ªåŸºäºwsl2çš„linuxå­ç³»ç»Ÿï¼ˆä¸ªäººåçˆ±ubuntuï¼‰

- apt å®‰è£… sagemathï¼ˆlinuxè‡ªå·±æŠ˜è…¾ï¼‰

  
  
  ![](https://gitee.com/ljahum/images/raw/master/img/20211128223016.png)

ç„¶åï¼Œè°ƒæ•´é¢œè‰²è®©ä»–å¥½çœ‹ä¸€ç‚¹ï¼ˆä¹Ÿå¯ä»¥ä¸æ”¹ï¼‰

![](https://gitee.com/ljahum/images/raw/master/img/20211129113709.png)

è°ƒå¥½äº†å¯ä»¥åœ¨terminalä¸­ç”¨`code .`ç”¨vscodeè”åŠ¨ç¼–ç¨‹

ä¹Ÿå¯ä»¥ç”¨ä¸Šæµçš„jupyterï¼Œæˆ‘é—²çš„æ— èŠæ­äº†ä¸ªsageçš„jupyterç¬”è®°æœ¬ç»™å¤§ä¼™ç©23333

http://139.224.231.64:8888/

å¯†ç 123321

## stream crypto

### éšæœºæ•°ç”Ÿæˆå™¨

#### mt19937

å¤§å¤šæ•°éšæœºæ•°ç®—æ³•çš„å®ç°æ–¹å¼

ä¸‰å¹´å‰çš„æ”»å‡»æ–¹æ³•ï¼šhttps://github.com/tna0y/Python-random-module-cracker

#### LCGçº¿æ€§åŒä½™ç”Ÿæˆå™¨

æ”»å‡»æ–¹æ³•ï¼šæ¨å…¬å¼

exampleï¼šhttps://github.com/fghcvjk/HGAME2021/blob/master/crypto/%E5%A4%BA%E5%AE%9D%E5%A4%A7%E5%86%92%E9%99%A92.py

#### çº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨ - LFSR

è¯´ç™½äº†å°±æ˜¯è§£ä¸€ä¸ªæ–¹ç¨‹ï¼Œå¦‚æœæœ‰ä½æ•°ç¼ºå¤±å¯ä»¥æƒ³åŠæ³•å»çˆ†ç ´

sagemathä¸­æœ‰å¿«é€Ÿè§£å†³æ±‚è¿ç®—ç¬¦ä¸ºå¼‚æˆ–çš„çŸ©é˜µçš„æ–¹æ³•

<img src="https://gitee.com/ljahum/images/raw/master/img/20211128222422.png" style="zoom:50%;" />

å¼‚æˆ–åœ¨æ•°å­¦ä¸Šè¢«ç§°ä¸ºGFæœ‰é™åŸŸä¸Šçš„åŠ æ³•ï¼Œå¯¹çŸ©é˜µæŒ‡å®šç±»å‹ï¼Œsageè‡ªåŠ¨å°†è¯¥çŸ©é˜µä¹‹åçš„è¿ç®—é™åˆ¶ä¸ºæˆ‘ä»¬è§„å®šçš„åŸŸä¸‹çš„è¿ç®—ï¼ˆæŒ‡å®šè¿ç®—æ–¹å¼ï¼‰

æ¨¡è¿ç®—å’Œå¤šé¡¹å¼ä¹Ÿæ˜¯å¯ä»¥çš„



## block-cipher

### æ¯”ç‰¹åè½¬

æœ€æœ€æœ€åŸºæœ¬çš„ä¸€ç§æ–¹å¼ï¼ŒæŠŠivæ‹¿ç»™åˆ«äººæ”¹ä¹Ÿæ˜¯æŒºè ¢çš„

### oracle padding attack

ä¸»æµçš„blockcipheræœ‰aesï¼Œdesç­‰ï¼Œçœ‹å®Œäº†wikiåº”è¯¥ä¼šæœ‰ä¸€ä¸ªåŸºæœ¬äº†è§£ï¼š

- å¯¹massageè¿›è¡Œåˆ†ç»„ï¼Œå¡«å……
- æ”¾å…¥åŠ å¯†å™¨ä¸­åŠ å¯†ï¼ŒåŠ å¯†çš„è§„åˆ™ç”±ç§˜é’¥å†³å®š
- è®²å¯†æ–‡è¾“å‡ºï¼Œè¾“å‡ºåçš„å¯†æ–‡å’Œæ˜æ–‡é•¿åº¦åº”è¯¥ä¿æŒä¸€æ ·

wikiä¸Šé¢å€¼ç»™å‡ºäº†åŠ å¯†å™¨ï¼ˆé»‘ç›’ï¼‰ä¸­çš„åˆ†æå’Œç ´è§£

ä½†ç°åœ¨æµé€šçš„blockcipherçš„é»‘ç›’å·²ç»ååˆ†ä¼˜ç§€äº†ï¼Œæ‰€ä»¥è¿™é‡Œå»ºè®®ä»å¡«å……ã€encrypto modeä¸Šçš„æ¼æ´ä¸‹æ‰‹

å¡«å……æ¼æ´æœ€ç»å…¸çš„å°±æ˜¯ECB å¡«å……å’ŒCBCå¡«å……

ecbå¡«å……æ˜¯åˆ©ç”¨å¾€ä¸‹ä¸€ä¸ªå—æ³„éœ²å•ä¸ªæœªçŸ¥å­—èŠ‚æ¥è¿›è¡Œè¯¸ä½çˆ†ç ´ï¼ˆå˜›ï¼Œæ²¡æœ‰æ‰¾åˆ°ä¾‹é¢˜ï¼Œç”»ä¸€ä¸ªå¥½äº†ï¼‰

![](https://gitee.com/ljahum/images/raw/master/img/SmartSelect_20211129-115937_Samsung%20Notes.jpg)



cbcå¡«å……ä¾‹é¢˜ï¼Œå’ŒecbåŸºæœ¬æ€æƒ³æ˜¯ä¸€æ ·çš„ï¼Œåœ¨ä¸€äº›åœ°æ–¹è¿›è¡Œäº†å°å°çš„ä¿®æ”¹

https://github.com/wm-team/WMCTF2020-WriteUp/blob/master/WMCTF%202020%E5%AE%98%E6%96%B9WriteUp.md#game

### cipherMode

wikiä¸Šé¢å·²ç»æŠŠåŸºæœ¬æ¨¡å¼è®²å¾—æ¯”è¾ƒè¯¦ç»†äº†ï¼Œ

https://ctf-wiki.org/crypto/blockcipher/mode/cfb/

cfb oracle paddingçš„æ”»å‡»æ–¹å¼

https://ljahum.top/bytectf2021/#document-for-justdecrypt

å…¶ä»–å¥‡å¥‡æ€ªæ€ªçš„ciphermodeçš„æ”»å‡»

- aes-ocb2æ¨¡å¼çš„æ”»å‡»æ–¹å¼

https://dawn-whisper.hack.best/2021/04/04/Wp_for_%E7%BA%A2%E6%98%8E%E8%B0%B7_crypto/#babyFogery

https://eprint.iacr.org/2018/1090.pdf

>  å˜›ï¼ŒåŸç†æœ‰ç‚¹å¤æ‚ï¼Œåšä¸ªç§¯ç´¯å°±è¡Œ



### DFA å·®åˆ†éšç§åˆ†æ

> è¿™ä¸ªç©æ„åªç¢°åˆ°è¿‡ä¸€æ¬¡ï¼Œç¢°åˆ°äº†åªèƒ½å»æé™æ‰¾èµ„æ–™ï¼Œç„¶åwpå…«æˆæ˜¯è·‘å›½å¤–ğŸ‘´çš„pocè·‘å‡ºæ¥çš„

githubä¸€æœå°±æœ‰ï¼Œæ‰¾åˆ°èƒ½ç”¨èƒ½ç©çš„å°±è¡Œ

å¤è‘£çº§ç©å…·

https://github.com/Daeinar/dfa-aes

å¯¹åº”é¢˜

https://github.com/ljahum/crypto-challenges/tree/main/ciscn2021/oddaes

æ–°ä¸€ç‚¹çš„(æ²¡ç”¨è¿‡)

https://github.com/SideChannelMarvels/JeanGrey

https://github.com/guojuntang/sm4_dfa

## RSA

> è¿™é‡Œæˆ‘ä»¬å…ˆæ€»ç»“éäº¤äº’æƒ…å†µä¸‹çš„rsaæ”»å‡»æ–¹å¼
>
> wikiä¸Šå·²ç»ç»™å‡ºäº†åŸºæœ¬çš„ç ´è§£æ–¹å¼è¿™é‡Œç›´æ¥ä»coppersmithå¼€å§‹



### æ ¼ç›¸å…³å‰ç½®çŸ¥è¯†

æ ¼å­¦ä¹ èµ„æ–™

>  è¿™é‡Œç»™å‡ºäº†åŸºæœ¬çš„æ ¼å’Œæ ¼ç›¸å…³ï¼Œé‡è¦çš„è¿˜æ˜¯åé¢çš„åº”ç”¨
>
> æ ¼ç›¸å…³çš„é¢˜ç›®è„šæœ¬æ›´å¤šçš„æ˜¯å¯¹é¢˜å®å…·å½¢å¼ï¼Œæ‰¾åˆ°è½®å­ä¸€æŠŠæ¢­å“ˆã€‚ã€‚ã€‚
>
> æ¯•ç«Ÿå¤ç°è®ºæ–‡æ‹¿æ¥å‡ºä¸­å‹èµ›é¢˜è¿‡äºå¥¢ä¾ˆäº†

by HITé˜®å¸ˆå‚… ï¼Œåšå®¢æ ¼ç›¸å…³å…¥é—¨å†…å®¹ç¿»è¯‘è´¨é‡éå¸¸é«˜ï¼ˆé«˜äºä¸€äº›å­¦è€…çš„ç¿»è¯‘ï¼‰ï¼Œä½†ä»æœ‰éå¸¸æ¨¡æ£±ä¸¤å¯çš„éƒ¨åˆ†

https://www.ruanx.net/coppersmith/

> èƒŒåŒ…ç®—æ³•wikiä¸Šç»™çš„æ¯”è¾ƒè¯¦ç»†äº†ï¼Œå¯ä»¥é…åˆé˜®å¸ˆå‚…çš„åšå®¢æ„é€ ä¸€ä¸‹æ ¼å­

é™¤wikiä»¥å¤–çš„åŠ å¼ºç‰ˆcopperè„šæœ¬

https://github.com/defund/coppersmith

### ç±»ç»´çº³é¢˜å‹ ï¼ˆç§é’¥dè¾ƒå°ï¼‰

wikiç»™å‡ºäº†$d<N^{0.29}$çš„èŒƒå›´çš„å½¢å¼

æŸæ¬¡æ¯”èµ›ç»™å‡ºäº†æ‰©å±•å½¢å¼ï¼Œæœ¬æ–‡ç« ç¿»è¯‘å¾—æ¯”è¾ƒå¥½ï¼Œè¯æ˜å¹³æ¿ä¹Ÿæ¯”è¾ƒé«˜è´¨é‡

è¿™ä¸ªé¢˜æŠŠdèŒƒå›´æ‰©å±•åˆ°äº†$d<N^{5\over 14}$

https://blog.csdn.net/jcbx_/article/details/109306542

> å˜›ï¼Œæ ¸å¿ƒç‚¹å«–åˆ°è„šæœ¬å°±å®Œäº‹
>
> ç†è§£å±‚é¢çœ‹æ‡‚æ€ä¹ˆä»å…¬å¼æ„é€ åˆ°æ ¼å­å°±è¡Œ
>
> å‘ƒå‘ƒå‘ƒ,å¥½åƒè¿™ä¸ªwikiå·²ç»æ”¶å½•äº†,çœ‹æ¥wikiå¹¶æ²¡æœ‰åœæ­¢è¿ç»´....

### Common Private Exponent

ä¸€ä¸ª2019å¹´æ²¡äººç©ï¼Œ2021å¹´è¢«æ‰“çƒ‚çš„çŸ¥è¯†ç‚¹ï¼Œæ„é€ æ ¼å­çš„ç»å…¸æ¡ˆä¾‹

https://github.com/SycloverSecurity/SCTF2020/tree/master/Crypto/RSA



### å…±æ¨¡æ”»å‡»plus

https://github.com/De1ta-team/De1CTF2020/tree/master/writeup/crypto/easyRSA

æœ‰åˆ«ä¸æ­£å¸¸çš„å…¬æ¨¡ï¼Œè¿™ç©æ„åªç»™äº†ä¸€ç»„å…¬é’¥ï¼Œè„šæœ¬ç»™å‡ºäº†2ç»„å…¬é’¥åˆ†è§£Nçš„æ ¼å­æ„é€ æ–¹å¼

å››ç»„çš„:

https://huangx607087.online/2021/03/01/LatticeNotes6/#toc-heading-6 

è¿™ä¸ªåšå®¢é‡Œé¢è¿˜æœ‰å¾ˆå¤šå…¶ä»–æ€»ç»“å¾—éå¸¸å¥½çš„ä¸œè¥¿ï¼Œç»´çº³åŒ…æ‹¬ç»´çº³æ‰©å±•çš„æ€»ç»“



### Known High Bits Message Attack AND Coppersmithâ€™s short-pad attack etc.

è¿™ç©æ„çº¯çº¯çš„å±¯è„šæœ¬äº†

æ¨èé¢˜ç›®:https://blog.csdn.net/zippo1234/article/details/109409929

ç¯å¢ƒï¼šhttps://github.com/CTFTraining/qwb_2019_crypto_copperstudy

### RSA é€‰æ‹©æ˜å¯†æ–‡æ”»å‡»

wikiç»™å‡ºäº†ä¸‰ç§æ”»å‡»æ–¹å¼

- æ³„éœ²è§£å¯†åçš„æœ€ä½ä½byte
- æ³„éœ²è§£å¯†åçš„æœ€ä½ä½bit(å¥‡å¶æ€§)
- æ³„éœ²è§£å¯†åçš„æœ€ä½ä½bit(å¥‡å¶æ€§),ä½†æ¯æ¬¡ä¼šå˜,è¿™æ—¶ç®—æ³•å˜ä¸ºç»™å¯†æ–‡ä¹˜ä¸Š$(2^{-i})^e\pmod{n}$,ä¹Ÿæ˜¯ä¸€ç§å¾ˆå¥½çš„æ€è·¯

æ‰©å±•:

- é«˜ä½æ³„éœ²

è¿™ç§æƒ…å†µå°±ä¸èƒ½ç”¨ä¹˜$2^i$çš„æ–¹å¼æ¥æ³„éœ²ä¸åŒä½ç½®çš„æ˜æ–‡äº†,å› ä¸ºè¶…è¿‡nåä¼šè¢«æ¨¡æ‰

å½±å“æ˜æ–‡çš„æ•°æ®,æ‰€ä»¥è¦ç”¨äºŒåˆ†æ³•çš„æ€æƒ³å»æ

ä¾‹é¢˜:

https://ljahum.top/%E5%A4%8D%E7%9B%982/#%E8%93%9D%E5%B8%BDber-final

- miniç‰ˆ[Bleichenbacher Attack](https://crypto.stackexchange.com/questions/12688/can-you-explain-bleichenbachers-cca-attack-on-pkcs1-v1-5)

å—é‚®ğŸ‘´çš„ç»ƒä¹ é¢˜,æœ¬è´¨ä¸Šä¹Ÿæ˜¯äºŒåˆ†æ³•çš„æ€æƒ³

src https://github.com/fghcvjk/NCTF2020/tree/master/crypto/Oracle

wp https://ctf.njupt.edu.cn/562.html#Oracle

### æ•°å­¦/ç®—æ³•é¢˜

#### æ•°è®ºé¢˜:

- ä¸œåæ¯2020

https://github.com/ljahum/crypto-challenges/tree/main/2020%E5%BD%92%E6%A1%A3/%E4%B8%8A%E6%B5%B7%E5%A4%A7%E5%AD%A6%E7%94%9F2020/baby_rsa

- ä¸œåæ¯2021ï¼ˆæ¯å¹´éƒ½æ¥æ¶å¿ƒäººäº†å±äºæ˜¯ï¼‰

https://blog.csdn.net/weixin_56678592/article/details/121194962

- gkctf2021

https://blog.csdn.net/weixin_51867782/article/details/118573717

- ç¥¥äº‘æ¯2020 more_calc(é“¶è¡ŒèµåŠ©çš„æŠ¢é’±å¤§èµ›)

ä¸‹é¢çš„è¿æ¥æ²¡ä»£ç ,é™„ä¸€ä¸ª

```python
import gmpy2
from Crypto.Util.number import *

flag = b"flag{xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx}"

p = getStrongPrime(2048)
for i in range(1, (p+1)//2):
    s += pow(i, p-2, p)
s = s % p
q = gmpy2.next_prime(s)
n = p*q
e = 0x10001
c = pow(bytes_to_long(flag), e, n)
print(p)
print(c)
#27405107041753266489145388621858169511872996622765267064868542117269875531364939896671662734188734825462948115530667205007939029215517180761866791579330410449202307248373229224662232822180397215721163369151115019770596528704719472424551024516928606584975793350814943997731939996459959720826025110179216477709373849945411483731524831284895024319654509286305913312306154387754998813276562173335189450448233216133842189148761197948559529960144453513191372254902031168755165124218783504740834442379363311489108732216051566953498279198537794620521800773917228002402970358087033504897205021881295154046656335865303621793069
#350559186837488832821747843236518135605207376031858002274245004287622649330215113818719954185397072838014144973032329600905419861908678328971318153205085007743269253957395282420325663132161022100365481003745940818974280988045034204540385744572806102552420428326265541925346702843693366991753468220300070888651732502520797002707248604275755144713421649971492440442052470723153111156457558558362147002004646136522011344261017461901953583462467622428810167107079281190209731251995976003352201766861887320739990258601550606005388872967825179626176714503475557883810543445555390014562686801894528311600623156984829864743222963877167099892926717479789226681810584894066635076755996423203380493776130488170859798745677727810528672150350333480506424506676127108526488370011099147698875070043925524217837379654168009179798131378352623177947753192948012574831777413729910050668759007704596447625484384743880766558428224371417726480372362810572395522725083798926133468409600491925317437998458582723897120786458219630275616949619564099733542766297770682044561605344090394777570973725211713076201846942438883897078408067779325471589907041186423781580046903588316958615443196819133852367565049467076710376395085898875495653237178198379421129086523

```

https://blog.csdn.net/cccchhhh6819/article/details/110302200

> å˜›,å‰å¹´ç¥¥äº‘æ¯è¿˜æœ‰å‡ ä¸ªå…¶ä»–çš„å°æ•°å­¦é¢˜

https://www.anquanke.com/post/id/223383#h3-22

#### ç®—æ³•(å‰ªæ)

> è¿™ç§å§,å°±æ˜¯æ¢ç€æ³•å­æ¶å¿ƒäºº,æ¢ä¸ªå§¿åŠ¿åˆæ˜¯ä¸€ä¸ªæ–°é¢˜,å¯¹å¯¹åº”çš„æ–°é—®é¢˜åˆè¦é‡æ–°å®‰æ’å‰ªæçš„æ¡ä»¶
>
> å¤§æ¯”èµ›ä¸€èˆ¬ä¸ä¼šå‡ºï¼Œå°æ¯”èµ›ç”¨è¿™ä¸ªæ‹–æ—¶é—´

1.[GKCTF 2021]XOR

https://blog.csdn.net/m0_57291352/article/details/119974008

2.Mini-L CTF 2021-asr 

SRC:

https://github.com/traLk/Mini-L-CTF-2021/blob/main/Challenges/Crypto/asr/task.py

solveï¼š

https://d33b4t0.com/H4n53r-TEAM/#asr-dbt-done

etc. buuä¸Šè®°å¾—æœ‰ä¸€äº›ç±»ä¼¼çš„ï¼Œç®—æ˜¯ä¸€ç§è¿‘æœŸè¢«æŒ–æ˜å‡ºæ¥çš„ç©æ³•å§ã€‚ã€‚ã€‚ã€‚



## ç¦»æ•£å¯¹æ•°



> ç¦»æ•£å¯¹æ•°å³ç¦»æ•£ä¹Ÿå¯¹æ•°
>
> ä¸»è¦ä½“ç°å¯ä»¥ç†è§£ä¸ºåœ¨å’±çš„è¿ç®—æ¨¡å¼ä¸‹åªæœ‰åŠ æ³•æ²¡æœ‰ä¹˜æ³•
>
> å¯ä»¥ç”¨åŠ æ³•å®ç°äº†å¿«é€Ÿä¹˜æ³•å´æ²¡æœ‰å¿«é€Ÿé™¤æ³•
>
> è¿™é‡Œæ•´ç†äº†è¾ƒä¸ºå¸¸è§çš„ç¦»æ•£å¯¹æ•°ç©æ³•ï¼ŒECCåŠ å¯†å’ŒDSAç­¾å



## DSAç›¸å…³

### å¸¸è§„DSA



åŸºæœ¬æ”»å‡»è¦ç‚¹wikiå·²ç»è®²è¿‡äº†ï¼Œæ•´ä¸ªä¾‹é¢˜

- ä¸œå2020

https://github.com/ljahum/crypto-challenges/tree/main/2020%E5%BD%92%E6%A1%A3/%E4%B8%8A%E6%B5%B7%E5%A4%A7%E5%AD%A6%E7%94%9F2020/baby_dsa

- ç‹®å¼2020 å¥½åƒæ‰¾ä¸åˆ°æ¨å¯¼çš„å…¬å¼äº†ï¼Œè¿™ä¸ªé¢˜æ˜¯åˆšå¼€å§‹å­¦å¯†ç çš„æ—¶å€™ç¢°åˆ°çš„ï¼Œç°åœ¨çœ‹èµ·æ¥çœŸç®€å•å•Šã€‚ã€‚ã€‚ã€‚ã€‚

https://github.com/ljahum/crypto-challenges/tree/main/2020%E5%BD%92%E6%A1%A3/%E5%98%B6%E5%90%BC

wp https://blog.csdn.net/jcbx_/article/details/110944601

### ECDSA

é˜¿å·´é˜¿å·´ï¼Œçå‡ æŠŠæœæœåˆ°äº†UESTCğŸ‘´çš„ppthttps://blog.arpe1s.xyz/files/DSA.pdf

é‡Œé¢ç”±å…³äºLLLçš„éƒ¨åˆ†ä¸»è¦æ˜¯ä¸ºäº†è§£å†³bias nonce attckæ ¼å­çš„æ„é€ ï¼škä½ä½æ³„éœ²çš„æ”»å‡»æ–¹å¼

https://github.com/daedalus/BreakingECDSAwithLLL è¿™ä¸ªä»“åº“ç»™å‡ºäº†å¯¹äºECDSA bias nonce attck çš„æ”»å‡»è„šæœ¬å’Œæ”»å‡»èŒƒå›´ï¼ˆèŒƒå›´åœ¨è®ºæ–‡é‡Œé¢ï¼‰

ECDSAå’ŒDSAæ ¸å¿ƒç­¾åçš„æ–¹å¼æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯è®¡ç®—ç¦»æ•£å¯¹æ•°æ•°å€¼çš„æ–¹å¼ä¸ä¸€æ ·ï¼Œåº”è¯¥å¯ä»¥ä½œç”¨äºå¸¸è§„DSAğŸ’€

- å¯¹äºweak ecdsaçš„ä¸€äº›è®¨è®º

é‡Œé¢ä»£ç ä¸èƒ½ç›´æ¥ç”¨ï¼Œè¦æ”¹ä¸€ä¸‹

https://blog.trailofbits.com/2020/06/11/ecdsa-handle-with-care/















